<!doctype html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>New + New</title>
  <meta name="description" content="Streaming the Future of News">


  <!--<link href="assets/css/font-awesome.min.css" rel="stylesheet">-->
  <!--<script src="slick/slick/js/vendor/modernizr.js"></script>--> 


    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Streaming the Future of News</title>
    <!-- Bootstrap core CSS -->
    <!-- <link href="assets/css/bootstrap.css" rel="stylesheet"> -->
    <!-- Custom styles for this template -->
    <!--<link href="assets/css/main.css" rel="stylesheet">
    <link href="assets/css/font-awesome.min.css" rel="stylesheet">
    <link href="assets/css/prism.css" rel="stylesheet" />
    <link href="assets/css/jquery.mCustomScrollbar.css" rel="stylesheet" type="text/css" />-->
    <!-- jQuery library (served from Google) -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!-- bxSlider Javascript file -->
    <script src="jquery.bxslider.min.js"></script>
    <!-- bxSlider CSS file -->
    <link href="jquery.bxslider.css" rel="stylesheet" />
    <script src="moment.min.js"></script>
    <script src="livestamp.min.js"></script>
    
</head>

<body>
  <!-- Here we are! -->
  <div class="newstream"></div>
  <p><a href="" id="reload-slider">Click to add a slide, then reload the slider</a></p>

  <script type="text/javascript">
    //$(document).ready(function(){
      var slider = $('.newstream').bxSlider({
        mode: 'vertical',
        slideWidth: 1200,
        minSlides: 8,
        moveSlides: 1,
        slideMargin: 10,
        auto: false,
        autoControls: true,
        controls: true,
        pager: false,
        speed: 500
      });
    //});

    /*var slider = $('.bxslider').bxSlider({
      mode: 'horizontal'
    });*/
  </script>

  <script>

    buildStream()
    var myVar=setInterval(function () {buildStream()}, 6000);

    function buildStream(){
      $.getJSON("http://duck.media.mit.edu:8484/recent?minutes=10", function(data, status){
        data = data['result'];
        console.log(data);
        for (var i = 0; i < data.length; i++){
          var date = new Date(data[i]['datetime']);
          //console.log( date.toISOString());
          var hours = date.getHours();
          var ampm = (hours >= 12) ? "PM" : "AM";
          hours = hours % 12 || 12;
          if (hours < 10) {hours = hours;}
          var minutes = date.getMinutes(); 
          if (minutes < 10) {minutes = "0"+minutes;}

          $('.newstream').append( 
            "<div id='slide'>" +
               "<a href='" + data[i]['url'] + "' target='_blank' class='fill-div'>" +
                "<div class='article-title'>" + data[i]['title'] + "<span> [" + data[i]['org'] + "] </span>" + "</div>" +
                //"<div class='ago'><span data-livestamp='" + date.toISOString() + "''>Loading time</span></div>" +
                "<div class='description'>" + data[i]['desc'] + "</div>" +
                "<div class='right'>" +
                  "<div class='ago'><span data-livestamp='" + date.toISOString() + "''>Loading time</span></div>" +
                    //"<div class='thumbnail'>" +
                      //"<div class='img'>" + "<img src='../assets/img/thumbnails/" + 
                      //      data[i]['org'] + ".png'>" + "</div>" +
                        //"<div class='date'>" + hours + ":" + minutes + ampm + "</div>" +
                        
                    //"</div>" +
                "</div>" +
            "</div>"
            );
                        //$('li').last().css('background-image', 'url(' + "../assets/img/headers/" + 
                        //   data[i]['org'] + ".png" + ')');
          
          slider.reloadSlider();
          }
        });

      
        console.log("built");

      }


  </script>



  <script type="text/javascript">
    $('#reload-slider').click(function(e){
      e.preventDefault();
      $('.newstream').append('<div class="slide"><img src="http://placehold.it/1500x100&text=ADDED THIS"></div>');
      slider.reloadSlider();
    });
  </script>


<!--
<ul class="bxslider">
  <li><img src="/images/730_200/tree_root.jpg" title="Funky roots" /></li>
  <li><img src="/images/730_200/hill_road.jpg" title="The long and winding road" /></li>
</ul>

<p><a href="" id="reload-slider">Click to add a slide, then reload the slider</a></p>
-->





</body>
</html>
